local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KeySystem"
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 400, 0, 280)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -140)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = mainFrame

local topBar = Instance.new("Frame")
topBar.Name = "TopBar"
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.Position = UDim2.new(0, 0, 0, 0)
topBar.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame

local topBarCorner = Instance.new("UICorner")
topBarCorner.CornerRadius = UDim.new(0, 8)
topBarCorner.Parent = topBar

local leftText = Instance.new("TextLabel")
leftText.Name = "LeftText"
leftText.Size = UDim2.new(1, 0, 1, 0)
leftText.Position = UDim2.new(0, 0, 0, 0)
leftText.BackgroundTransparency = 1
leftText.Text = "Neysonov Hub"
leftText.TextColor3 = Color3.fromRGB(255, 255, 255)
leftText.TextSize = 14
leftText.Font = Enum.Font.GothamSemibold
leftText.TextXAlignment = Enum.TextXAlignment.Left
leftText.Parent = topBar

local leftPadding = Instance.new("UIPadding")
leftPadding.PaddingLeft = UDim.new(0, 15)
leftPadding.Parent = leftText

local rightText = Instance.new("TextLabel")
rightText.Name = "RightText"
rightText.Size = UDim2.new(0.5, 0, 1, 0)
rightText.Position = UDim2.new(0.5, 0, 0, 0)
rightText.BackgroundTransparency = 1
rightText.Text = ""
rightText.TextColor3 = Color3.fromRGB(200, 200, 200)
rightText.TextSize = 12
rightText.Font = Enum.Font.Gotham
rightText.TextXAlignment = Enum.TextXAlignment.Right
rightText.Parent = topBar

local rightPadding = Instance.new("UIPadding")
rightPadding.PaddingRight = UDim.new(0, 15)
rightPadding.Parent = rightText

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
closeButton.BorderSizePixel = 0
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 14
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = topBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeButton

local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, -30, 1, -70)
contentFrame.Position = UDim2.new(0, 15, 0, 50)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "Введите ключ для доступа"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 16
title.Font = Enum.Font.GothamSemibold
title.Parent = contentFrame

local textBox = Instance.new("TextBox")
textBox.Name = "KeyTextBox"
textBox.Size = UDim2.new(1, 0, 0, 40)
textBox.Position = UDim2.new(0, 0, 0, 40)
textBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
textBox.BorderSizePixel = 0
textBox.PlaceholderText = "Введите ключ здесь..."
textBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
textBox.Text = ""
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.TextSize = 14
textBox.Font = Enum.Font.Gotham
textBox.ClearTextOnFocus = false
textBox.Parent = contentFrame

local textBoxCorner = Instance.new("UICorner")
textBoxCorner.CornerRadius = UDim.new(0, 6)
textBoxCorner.Parent = textBox

local textBoxPadding = Instance.new("UIPadding")
textBoxPadding.PaddingLeft = UDim.new(0, 10)
textBoxPadding.PaddingRight = UDim.new(0, 10)
textBoxPadding.Parent = textBox

local messageText = Instance.new("TextLabel")
messageText.Name = "MessageText"
messageText.Size = UDim2.new(1, 0, 0, 20)
messageText.Position = UDim2.new(0, 0, 0, 85)
messageText.BackgroundTransparency = 1
messageText.Text = ""
messageText.TextColor3 = Color3.fromRGB(255, 80, 80)
messageText.TextSize = 12
messageText.Font = Enum.Font.Gotham
messageText.TextXAlignment = Enum.TextXAlignment.Center
messageText.Parent = contentFrame

local checkButton = Instance.new("TextButton")
checkButton.Name = "CheckButton"
checkButton.Size = UDim2.new(1, 0, 0, 40)
checkButton.Position = UDim2.new(0, 0, 0, 110)
checkButton.BackgroundColor3 = Color3.fromRGB(80, 120, 255)
checkButton.BorderSizePixel = 0
checkButton.Text = "Проверить"
checkButton.TextColor3 = Color3.fromRGB(255, 255, 255)
checkButton.TextSize = 14
checkButton.Font = Enum.Font.GothamSemibold
checkButton.Parent = contentFrame

local checkButtonCorner = Instance.new("UICorner")
checkButtonCorner.CornerRadius = UDim.new(0, 6)
checkButtonCorner.Parent = checkButton

local getKeyButton = Instance.new("TextButton")
getKeyButton.Name = "GetKeyButton"
getKeyButton.Size = UDim2.new(1, 0, 0, 40)
getKeyButton.Position = UDim2.new(0, 0, 0, 160)
getKeyButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
getKeyButton.BorderSizePixel = 0
getKeyButton.Text = "Получить ключ"
getKeyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
getKeyButton.TextSize = 14
getKeyButton.Font = Enum.Font.GothamSemibold
getKeyButton.Parent = contentFrame

local getKeyButtonCorner = Instance.new("UICorner")
getKeyButtonCorner.CornerRadius = UDim.new(0, 6)
getKeyButtonCorner.Parent = getKeyButton

local function fadeIn()
    mainFrame.Size = UDim2.new(0, 0, 0, 0)
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.BackgroundTransparency = 1
    
    local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(mainFrame, tweenInfo, {
        Size = UDim2.new(0, 400, 0, 280),
        Position = UDim2.new(0.5, -200, 0.5, -140),
        BackgroundTransparency = 0
    })
    
    tween:Play()
end

local function fadeOut(callback)
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(mainFrame, tweenInfo, {
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        BackgroundTransparency = 1
    })
    
    tween:Play()
    tween.Completed:Connect(function()
        if callback then
            callback()
        end
    end)
end

local function createSecondGui()
    local secondGui = Instance.new("ScreenGui")
    secondGui.Name = "ScriptsHub"
    secondGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    secondGui.Parent = playerGui
    
    local mainFrame2 = Instance.new("Frame")
    mainFrame2.Name = "MainFrame"
    mainFrame2.Size = UDim2.new(0, 550, 0, 450)
    mainFrame2.Position = UDim2.new(0.5, -275, 0.5, -225)
    mainFrame2.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame2.BorderSizePixel = 0
    mainFrame2.Parent = secondGui
    
    local corner2 = Instance.new("UICorner")
    corner2.CornerRadius = UDim.new(0, 8)
    corner2.Parent = mainFrame2

    local topBar2 = Instance.new("Frame")
    topBar2.Name = "TopBar"
    topBar2.Size = UDim2.new(1, 0, 0, 40)
    topBar2.Position = UDim2.new(0, 0, 0, 0)
    topBar2.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    topBar2.BorderSizePixel = 0
    topBar2.Parent = mainFrame2
    
    local topBar2Corner = Instance.new("UICorner")
    topBar2Corner.CornerRadius = UDim.new(0, 8)
    topBar2Corner.Parent = topBar2
    
    local title2 = Instance.new("TextLabel")
    title2.Name = "Title"
    title2.Size = UDim2.new(1, -80, 1, 0)
    title2.Position = UDim2.new(0, 0, 0, 0)
    title2.BackgroundTransparency = 1
    title2.Text = "Neysonov Hub"
    title2.TextColor3 = Color3.fromRGB(255, 255, 255)
    title2.TextSize = 16
    title2.Font = Enum.Font.GothamSemibold
    title2.TextXAlignment = Enum.TextXAlignment.Left
    title2.Parent = topBar2
    
    local titlePadding = Instance.new("UIPadding")
    titlePadding.PaddingLeft = UDim.new(0, 15)
    titlePadding.Parent = title2
    
    local closeButton2 = Instance.new("TextButton")
    closeButton2.Name = "CloseButton"
    closeButton2.Size = UDim2.new(0, 30, 0, 30)
    closeButton2.Position = UDim2.new(1, -35, 0, 5)
    closeButton2.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton2.BorderSizePixel = 0
    closeButton2.Text = "X"
    closeButton2.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton2.TextSize = 14
    closeButton2.Font = Enum.Font.GothamBold
    closeButton2.Parent = topBar2
    
    local closeCorner2 = Instance.new("UICorner")
    closeCorner2.CornerRadius = UDim.new(0, 6)
    closeCorner2.Parent = closeButton2
    
    local contentArea = Instance.new("Frame")
    contentArea.Name = "ContentArea"
    contentArea.Size = UDim2.new(1, 0, 1, -40)
    contentArea.Position = UDim2.new(0, 0, 0, 40)
    contentArea.BackgroundTransparency = 1
    contentArea.Parent = mainFrame2
    
    local sidebar = Instance.new("Frame")
    sidebar.Name = "Sidebar"
    sidebar.Size = UDim2.new(0, 150, 1, 0)
    sidebar.Position = UDim2.new(0, 0, 0, 0)
    sidebar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    sidebar.BorderSizePixel = 0
    sidebar.Parent = contentArea
    
    local sidebarCorner = Instance.new("UICorner")
    sidebarCorner.CornerRadius = UDim.new(0, 8)
    sidebarCorner.Parent = sidebar
    
    local scriptsArea = Instance.new("Frame")
    scriptsArea.Name = "ScriptsArea"
    scriptsArea.Size = UDim2.new(1, -150, 1, 0)
    scriptsArea.Position = UDim2.new(0, 150, 0, 0)
    scriptsArea.BackgroundTransparency = 1
    scriptsArea.Parent = contentArea
    
    local mainCategory = Instance.new("TextButton")
    mainCategory.Name = "MainCategory"
    mainCategory.Size = UDim2.new(1, -10, 0, 40)
    mainCategory.Position = UDim2.new(0, 5, 0, 10)
    mainCategory.BackgroundColor3 = Color3.fromRGB(80, 120, 255)
    mainCategory.BorderSizePixel = 0
    mainCategory.Text = "Main"
    mainCategory.TextColor3 = Color3.fromRGB(255, 255, 255)
    mainCategory.TextSize = 14
    mainCategory.Font = Enum.Font.GothamSemibold
    mainCategory.Parent = sidebar
    
    local mainCategoryCorner = Instance.new("UICorner")
    mainCategoryCorner.CornerRadius = UDim.new(0, 6)
    mainCategoryCorner.Parent = mainCategory
    
    local scriptsContainer = Instance.new("ScrollingFrame")
    scriptsContainer.Name = "ScriptsContainer"
    scriptsContainer.Size = UDim2.new(1, -10, 1, -10)
    scriptsContainer.Position = UDim2.new(0, 5, 0, 5)
    scriptsContainer.BackgroundTransparency = 1
    scriptsContainer.BorderSizePixel = 0
    scriptsContainer.ScrollBarThickness = 6
    scriptsContainer.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
    scriptsContainer.Visible = true
    scriptsContainer.Parent = scriptsArea
    
    local scriptsLayout = Instance.new("UIListLayout")
    scriptsLayout.Name = "ScriptsLayout"
    scriptsLayout.Padding = UDim.new(0, 8)
    scriptsLayout.SortOrder = Enum.SortOrder.LayoutOrder
    scriptsLayout.Parent = scriptsContainer
    
    local scripts = {
        {
            name = "Aim+Esp",
            url = "https://raw.githubusercontent.com/agresiv111/script/refs/heads/main/main.lua"
        },
        {
            name = "Fly+Invisible(Activate E and R)",
            url = "https://pastebin.com/raw/HqwA3UdK"
        },
        {
            name = "Friday Funkin",
            url = "https://raw.githubusercontent.com/InfernusScripts/Fire-Hub/main/Loader"
        },
        {
            name = "Hitboxes",
            url = "https://raw.githubusercontent.com/Ranzesd/Hitboxes-Script/refs/heads/main/main"
        },
        {
            name = "TSB",
            url = "https://raw.githubusercontent.com/ATrainz/Phantasm/refs/heads/main/Games/TSB.lua"
        },
        {
            name = "Ultimate Battlegrounds",
            url = "https://eltonshub-loader.netlify.app/UBG1.lua"
        }
    }
    
    for i, scriptData in ipairs(scripts) do
        local button = Instance.new("TextButton")
        button.Name = scriptData.name .. "Button"
        button.Size = UDim2.new(1, 0, 0, 35)
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        button.BorderSizePixel = 0
        button.Text = scriptData.name
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.TextSize = 12
        button.Font = Enum.Font.Gotham
        button.Parent = scriptsContainer
        
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(0, 6)
        buttonCorner.Parent = button
        
        button.MouseButton1Click:Connect(function()
            local originalText = button.Text
            local originalColor = button.BackgroundColor3
            
            button.Text = "Загрузка..."
            button.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
            
            local success, errorMessage = pcall(function()
                loadstring(game:HttpGet(scriptData.url))()
            end)
            
            if success then
                button.Text = "Загружено!"
                button.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
            else
                button.Text = "Ошибка!"
                button.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
                warn("Ошибка загрузки скрипта " .. scriptData.name .. ": " .. tostring(errorMessage))
            end
            
            wait(2)
            button.Text = originalText
            button.BackgroundColor3 = originalColor
        end)
    end
    
    scriptsContainer.CanvasSize = UDim2.new(0, 0, 0, scriptsLayout.AbsoluteContentSize.Y)
    scriptsLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        scriptsContainer.CanvasSize = UDim2.new(0, 0, 0, scriptsLayout.AbsoluteContentSize.Y)
    end)
    
    local dragging = false
    local dragInput
    local dragStart
    local startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        mainFrame2.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    topBar2.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame2.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    topBar2.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    
    local function closeSecondGui()
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(mainFrame2, tweenInfo, {
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0),
            BackgroundTransparency = 1
        })
        
        tween:Play()
        tween.Completed:Connect(function()
            secondGui:Destroy()
        end)
    end
    
    closeButton2.MouseButton1Click:Connect(function()
        closeSecondGui()
    end)
    
    mainCategory.MouseButton1Click:Connect(function()
        scriptsContainer.Visible = not scriptsContainer.Visible
    end)
    
    mainFrame2.Size = UDim2.new(0, 0, 0, 0)
    mainFrame2.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame2.BackgroundTransparency = 1
    
    local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(mainFrame2, tweenInfo, {
        Size = UDim2.new(0, 550, 0, 450),
        Position = UDim2.new(0.5, -275, 0.5, -225),
        BackgroundTransparency = 0
    })
    
    tween:Play()
end

local function showMessage(text, color)
    messageText.Text = text
    messageText.TextColor3 = color
    
    delay(3, function()
        if messageText.Text == text then
            messageText.Text = ""
        end
    end)
end

closeButton.MouseButton1Click:Connect(function()
    fadeOut(function()
        screenGui:Destroy()
    end)
end)

checkButton.MouseButton1Click:Connect(function()
    local enteredKey = textBox.Text
    
    if enteredKey == "neysonovkeyloader134256" then
        showMessage("Ключ верный! Открываем доступ...", Color3.fromRGB(80, 255, 80))
        
        wait(1)
        fadeOut(function()
            screenGui:Destroy()
            createSecondGui()
        end)
    else
        showMessage("Неверный ключ", Color3.fromRGB(255, 80, 80))
        
        local originalPosition = textBox.Position
        for i = 1, 3 do
            textBox.Position = UDim2.new(0, 5, 0, 40)
            wait(0.05)
            textBox.Position = UDim2.new(0, -5, 0, 40)
            wait(0.05)
        end
        textBox.Position = originalPosition
    end
end)

getKeyButton.MouseButton1Click:Connect(function()
    setclipboard("https://discord.gg/EUn4UBcR")
    
    local originalText = getKeyButton.Text
    local originalColor = getKeyButton.BackgroundColor3
    
    getKeyButton.Text = "Успешно!"
    getKeyButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
    
    showMessage("Ссылка скопирована в буфер обмена", Color3.fromRGB(80, 180, 255))
    
    delay(2, function()
        getKeyButton.Text = originalText
        getKeyButton.BackgroundColor3 = originalColor
    end)
end)

fadeIn()

local connection
connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.Escape and not gameProcessed then
        connection:Disconnect()
        fadeOut(function()
            screenGui:Destroy()
        end)
    end
end)
